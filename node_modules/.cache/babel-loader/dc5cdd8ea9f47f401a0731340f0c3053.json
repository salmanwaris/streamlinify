{"ast":null,"code":"var _jsxFileName = \"/Users/SWKHAN/Downloads/streamlinify/src/components/Messages/MessageInput/MessageInput.component.jsx\";\nimport React, { useState } from 'react';\nimport { Segment, Input, Button } from \"semantic-ui-react\";\nimport firebase from \"../../../server/firebase\";\nimport { connect } from \"react-redux\";\nimport { ImageUpload } from \"../ImageUpload/ImageUpload.component\";\nimport uuidv4 from \"uuid/v4\";\n\nconst MessageInput = props => {\n  const messageRef = firebase.database().ref('messages');\n  const storageRef = firebase.storage().ref();\n  const [messageState, setMessageState] = useState(\"\");\n  const [fileDialogState, setFileDialog] = useState(false);\n\n  const createMessageInfo = downloadUrl => {\n    return {\n      user: {\n        avatar: props.user.photoURL,\n        name: props.user.displayName,\n        id: props.user.uid\n      },\n      content: messageState,\n      image: downloadUrl || \"\",\n      timestamp: firebase.database.ServerValue.TIMESTAMP\n    };\n  };\n\n  const sendMessage = downloadUrl => {\n    if (messageState || downloadUrl) {\n      messageRef.child(props.channel.id).push().set(createMessageInfo(downloadUrl)).then(() => setMessageState(\"\")).catch(err => console.log(err));\n    }\n  };\n\n  const onMessageChange = e => {\n    const target = e.target;\n    setMessageState(target.value);\n  };\n\n  const createActionButtons = () => {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n      icon: \"send\",\n      onClick: () => {\n        sendMessage();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      icon: \"upload\",\n      onClick: () => setFileDialog(true),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 13\n      }\n    }));\n  };\n\n  const uploadImage = (file, contentType) => {\n    const filePath = `chat/images/${uuidv4()}.jpg`;\n    storageRef.child(filePath).put(file, {\n      contentType: contentType\n    }).then(data => {\n      data.ref.getDownloadURL().then(url => {\n        sendMessage(url);\n      }).catch(err => console.log(err));\n    }).catch(err => console.log(err));\n  };\n\n  return /*#__PURE__*/React.createElement(Segment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    onChange: onMessageChange,\n    fluid: true,\n    name: \"message\",\n    value: messageState,\n    label: createActionButtons(),\n    labelPosition: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(ImageUpload, {\n    uploadImage: uploadImage,\n    open: fileDialogState,\n    onClose: () => setFileDialog(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }));\n};\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user.currentUser,\n    channel: state.channel.currentChannel\n  };\n};\n\nexport default connect(mapStateToProps)(MessageInput);","map":{"version":3,"sources":["/Users/SWKHAN/Downloads/streamlinify/src/components/Messages/MessageInput/MessageInput.component.jsx"],"names":["React","useState","Segment","Input","Button","firebase","connect","ImageUpload","uuidv4","MessageInput","props","messageRef","database","ref","storageRef","storage","messageState","setMessageState","fileDialogState","setFileDialog","createMessageInfo","downloadUrl","user","avatar","photoURL","name","displayName","id","uid","content","image","timestamp","ServerValue","TIMESTAMP","sendMessage","child","channel","push","set","then","catch","err","console","log","onMessageChange","e","target","value","createActionButtons","uploadImage","file","contentType","filePath","put","data","getDownloadURL","url","mapStateToProps","state","currentUser","currentChannel"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Segment, Input, Button } from \"semantic-ui-react\";\nimport firebase from \"../../../server/firebase\";\nimport { connect } from \"react-redux\";\nimport { ImageUpload } from \"../ImageUpload/ImageUpload.component\"\nimport uuidv4 from \"uuid/v4\";\n\nconst MessageInput = (props) => {\n\n    const messageRef = firebase.database().ref('messages');\n\n    const storageRef = firebase.storage().ref();\n\n    const [messageState, setMessageState] = useState(\"\");\n\n    const [fileDialogState, setFileDialog] = useState(false);\n\n    const createMessageInfo = (downloadUrl) => {\n        return {\n            user: {\n                avatar: props.user.photoURL,\n                name: props.user.displayName,\n                id: props.user.uid\n            },\n            content: messageState,\n            image : downloadUrl || \"\",\n            timestamp: firebase.database.ServerValue.TIMESTAMP\n        }\n    }\n\n    const sendMessage = (downloadUrl) => {\n        if (messageState || downloadUrl) {\n            messageRef.child(props.channel.id)\n                .push()\n                .set(createMessageInfo(downloadUrl))\n                .then(() => setMessageState(\"\"))\n                .catch((err) => console.log(err))\n        }\n    }\n\n    const onMessageChange = (e) => {\n        const target = e.target;\n        setMessageState(target.value);\n    }\n\n    const createActionButtons = () => {\n        return <>\n            <Button icon=\"send\" onClick={() => {sendMessage() }} />\n            <Button icon=\"upload\" onClick={() => setFileDialog(true)} />\n        </>\n    }\n\n    const uploadImage = (file, contentType) => {\n\n        const filePath = `chat/images/${uuidv4()}.jpg`;\n\n        storageRef.child(filePath).put(file, { contentType: contentType })\n            .then((data) => {\n                data.ref.getDownloadURL()\n                .then((url) => {\n                    sendMessage(url);\n                })\n                .catch((err) => console.log(err));\n            })\n            .catch((err) => console.log(err));\n    }\n\n    return <Segment>\n        <Input\n            onChange={onMessageChange}\n            fluid={true}\n            name=\"message\"\n            value={messageState}\n            label={createActionButtons()}\n            labelPosition=\"right\"\n        />\n        <ImageUpload uploadImage={uploadImage} open={fileDialogState} onClose={() => setFileDialog(false)} />\n    </Segment>\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        user: state.user.currentUser,\n        channel: state.channel.currentChannel\n    }\n}\n\nexport default connect(mapStateToProps)(MessageInput);"]},"metadata":{},"sourceType":"module"}